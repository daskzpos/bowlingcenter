<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900">

  <!-- Navigation bar -->
  <nav class="bg-black bg-opacity-80 backdrop-blur-lg shadow-lg">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        
        <!-- Logo/Titel -->
        <div class="flex items-center">
          <h1 class="text-white text-2xl font-bold">Brooklyn Bowl</h1>
        </div>
        
        <!-- Rechts: Welkom + Uitloggen -->
        <div class="flex items-center gap-4">
          <span class="text-gray-300">Welkom, <span class="text-orange-400 font-semibold">Gebruiker</span></span>
          <a href="login.html" class="bg-orange-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-orange-700 transition">
            Uitloggen
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- Welkom sectie -->
    <div class="bg-gradient-to-r from-orange-600 to-orange-500 rounded-2xl p-8 mb-8 shadow-xl">
      <h2 class="text-white text-4xl font-bold mb-2">Welkom terug! üé≥</h2>
      <p class="text-white text-lg">Klaar voor een nieuwe bowlingsessie?</p>
    </div>

    <!-- Dashboard cards (2 kolommen, 50/50, gecentreerd) -->
    <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
      
      <!-- Card 1: Nieuwe Reservering -->
      <div class="bg-gray-800 rounded-xl p-6 shadow-lg hover:shadow-2xl transition">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-white text-xl font-bold">Nieuwe Reservering</h3>
          <span class="text-4xl">üìÖ</span>
        </div>
        <p class="text-gray-400 mb-4">Reserveer een baan voor jouw groep</p>
         <a href="/pages/gastReserveer.html"
            class="w-full inline-block bg-orange-600 text-white py-2 rounded-lg font-semibold text-center hover:bg-orange-700 transition">
            Reserveren
          </a>
      </div>

      <!-- Card 2: Mijn Scores -->
      <div class="bg-gray-800 rounded-xl p-6 shadow-lg hover:shadow-2xl transition">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-white text-xl font-bold">Mijn Scores</h3>
          <span class="text-4xl">üèÜ</span>
        </div>
        <p class="text-gray-400 mb-4">Bekijk je bowlingstatistieken</p>
        <a href="/pages/mijnScores.html" class="w-full inline-block bg-orange-600 text-white py-2 rounded-lg font-semibold text-center hover:bg-orange-700 transition">
          Mijn Scores
        </a>
      </div>

    </div>

    <!-- Aankomende reserveringen sectie -->
    <div class="bg-gray-800 rounded-xl p-6 shadow-lg">
      <h3 class="text-white text-3xl font-bold mb-4">Reserveringen</h3>
      <h3 class="text-white text-1xl font-bold mb-4">Aankomende reserveringen:</h3>
      
      <div id="upcoming-reservations">
        <p class="text-gray-400 text-center py-8">Geen aankomende reserveringen</p>
      </div>
      
      <h3 class="text-white text-1xl font-bold mb-4 mt-6">Afgelopen reserveringen:</h3>
      
      <div id="past-reservations">
        <p class="text-gray-400 text-center py-8">Geen afgelopen reserveringen</p>
      </div>
    </div>

  </div>

  <script>
    // Load user reservations
    async function loadReservations() {
      try {
        const response = await fetch('/php/getUserReservations.php');
        const data = await response.json();
        
        if (data.success) {
          // Display upcoming reservations
          const upcomingContainer = document.getElementById('upcoming-reservations');
          if (data.upcoming && data.upcoming.length > 0) {
            upcomingContainer.innerHTML = data.upcoming.map(res => `
              <div class="bg-gray-700 rounded-lg p-4 mb-3 flex flex-col md:flex-row md:justify-between md:items-center gap-4">
                <div>
                  <p class="text-white font-semibold">Reservering #${res.reservation_id}</p>
                  <p class="text-gray-400 text-sm">${res.date_formatted}, ${res.start_time} - ${res.end_time}</p>
                  <p class="text-gray-400 text-sm">${res.number_of_adults} volwassenen${res.number_of_kids > 0 ? ', ' + res.number_of_kids + ' kinderen' : ''}</p>
                </div>
                <div class="flex gap-2">
                  <button onclick="cancelReservation(${res.reservation_id})" class="bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-red-700 transition">  
                    Annuleren  
                  </button>
                </div>
              </div>
            `).join('');
          }
          
          // Display past reservations
          const pastContainer = document.getElementById('past-reservations');
          if (data.past && data.past.length > 0) {
            pastContainer.innerHTML = data.past.map(res => `
              <div class="bg-gray-700 rounded-lg p-4 mb-3 flex flex-col md:flex-row md:justify-between md:items-center gap-4">
                <div>
                  <p class="text-white font-semibold">Reservering #${res.reservation_id}</p>
                  <p class="text-gray-400 text-sm">${res.date_formatted}, ${res.start_time} - ${res.end_time}</p>
                  <p class="text-gray-400 text-sm">${res.number_of_adults} volwassenen${res.number_of_kids > 0 ? ', ' + res.number_of_kids + ' kinderen' : ''}</p>
                </div>

              </div>
            `).join('');
          }
        }
      } catch (error) {
        console.error('Error loading reservations:', error);
      }
    }
    
    // Load reservations on page load
    loadReservations();
    
    // Cancel reservation function
    async function cancelReservation(reservationId) {
      if (!confirm('Weet u zeker dat u deze reservering wilt annuleren?')) {
        return;
      }
      
      try {
        const response = await fetch('/php/deleteReservation.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ reservation_id: reservationId })
        });
        
        const result = await response.json();
        
        if (result.success) {
          alert('Reservering succesvol geannuleerd');
          loadReservations(); // Reload the list
        } else {
          alert('Fout bij annuleren: ' + result.message);
        }
      } catch (error) {
        console.error('Error canceling reservation:', error);
        alert('Er is een fout opgetreden bij het annuleren van de reservering');
      }
    }
  </script>

</body>
</html>